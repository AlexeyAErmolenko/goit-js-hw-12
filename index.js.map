{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport { per_page } from '../main.js';\n\nexport const getImagesByQuery = (query, page) => {\n  axios.defaults.baseURL = 'https://pixabay.com/api/';\n  const API_KEY = '50578368-dd70245762fcec5298974d7f8';\n  const searchParams = new URLSearchParams({\n    key: API_KEY,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    q: query,\n    page: page,\n    per_page: per_page,\n  });\n  return axios.get(`?${searchParams}`);\n};\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { loadMore } from '../main.js';\n\nconst refs = {\n  gallery: document.querySelector('.gallery'),\n  loader: document.querySelector('.loader'),\n  // btnLoadMore: document.querySelector('.btnLoadMore'),\n};\nconst { gallery, loader /*, btnLoadMore*/ } = refs;\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  overlay: true,\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 100,\n});\n\nexport const createGallery = images => {\n  const imagesData = images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<a href=\"${largeImageURL}\">\n        <img src=\"${webformatURL}\" alt=\"${tags}\"/>        \n        <ul class=\"imagesData\">\n          <li class=\"liImageData\">\n            <h3 class=\"h3ImageData\">likes</h3>\n            <p class=\"pImageData\">${likes}</p>\n          </li>\n          <li class=\"liImageData\">\n            <h3 class=\"h3ImageData\">views</h3>\n            <p class=\"pImageData\">${views}</p>\n          </li>\n          <li class=\"liImageData\">\n            <h3 class=\"h3ImageData\">comments</h3>\n            <p class=\"pImageData\">${comments}</p>\n          </li>\n          <li class=\"liImageData\">\n            <h3 class=\"h3ImageData\">downloads</h3>\n            <p class=\"pImageData\">${downloads}</p>\n          </li>\n        </ul>\n      </a>`\n    )\n    .join('');\n  gallery.insertAdjacentHTML('beforeend', imagesData);\n  lightbox.refresh();\n};\n\nexport const clearGallery = () => {\n  gallery.innerHTML = '';\n};\n\nexport const showLoader = () => {\n  loader.classList.remove('isHidden');\n};\n\nexport const hideLoader = () => {\n  loader.classList.add('isHidden');\n};\n\nexport const showLoadMoreButton = () => {\n  loadMore.classList.remove('isHidden');\n};\n\nexport const hideLoadMoreButton = () => {\n  loadMore.classList.add('isHidden');\n};\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst refs = {\n  input: document.querySelector('input'),\n  btnSubmit: document.querySelector('.btnSubmit'),\n  form: document.querySelector('.form'),\n  btnLoadMore: document.querySelector('.btnLoadMore'),\n};\nconst { input, btnSubmit, form, btnLoadMore } = refs;\n\nexport const loadMore = btnLoadMore;\nimport { getImagesByQuery } from './js/pixabay-api';\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n} from './js/render-functions';\n\nlet searchQuery = '';\nlet page = 1;\nexport const per_page = 15;\nlet maxPage;\nlet height2scroll;\nfunction onInput(event) {\n  return (searchQuery = event.target.value);\n}\ninput.addEventListener('input', onInput);\n\nasync function onFormSubmit(event) {\n  clearGallery();\n  page = 1;\n  event.preventDefault();\n  if (!searchQuery.trim()) {\n    hideLoader();\n    return;\n  }\n  showLoader();\n  btnSubmit.setAttribute('disabled', ' ');\n  const { data } = await getImagesByQuery(searchQuery, page);\n  try {\n    if (!data.hits.length) {\n      OnAxiosError();\n      return;\n    }\n    createGallery(data.hits);\n    const rect = document.querySelector('a').getBoundingClientRect();\n    height2scroll = 2 * rect.height;\n    hideLoader();\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: `❌` + error,\n      position: 'topRight',\n      maxWidth: 350,\n    });\n    hideLoader();\n  }\n  maxPage = Math.ceil(data.totalHits / per_page);\n  if (maxPage > page) {\n    showLoadMoreButton();\n  } else {\n    iziToast.info({\n      message: `We're sorry, but you've reached the end of search results.`,\n      position: 'topRight',\n    });\n  }\n  form.reset();\n  btnSubmit.removeAttribute('disabled');\n}\nform.addEventListener('submit', onFormSubmit);\n\nasync function onBtnLoadMore(event) {\n  event.preventDefault();\n  page += 1;\n  showLoader();\n  const { data } = await getImagesByQuery(searchQuery, page);\n  try {\n    createGallery(data.hits);\n    window.scrollBy({ left: 0, top: height2scroll, behavior: 'smooth' });\n    hideLoader();\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: `❌` + error,\n      position: 'topRight',\n      maxWidth: 350,\n    });\n    hideLoader();\n  }\n  if (maxPage === page) {\n    iziToast.info({\n      message: `We're sorry, but you've reached the end of search results.`,\n      position: 'topRight',\n    });\n    hideLoader();\n    hideLoadMoreButton();\n    btnLoadMore.removeEventListener('click', onBtnLoadMore);\n  }\n  btnSubmit.removeAttribute('disabled');\n}\nbtnLoadMore.addEventListener('click', onBtnLoadMore);\n\nfunction OnAxiosError() {\n  iziToast.error({\n    message:\n      `Sorry, there are no images matching ` +\n      `your search query. Please try again!`,\n    position: 'topRight',\n    maxWidth: 350,\n  });\n  hideLoader();\n  form.reset();\n}\n"],"names":["getImagesByQuery","query","page","axios","API_KEY","searchParams","per_page","refs","gallery","loader","lightbox","SimpleLightbox","createGallery","images","imagesData","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","showLoader","hideLoader","showLoadMoreButton","loadMore","hideLoadMoreButton","input","btnSubmit","form","btnLoadMore","searchQuery","maxPage","height2scroll","onInput","event","onFormSubmit","data","OnAxiosError","error","iziToast","onBtnLoadMore"],"mappings":"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"}